---
title: 计算几何
date: 2025-09-7 14:25:00
tags: [编程，竞赛]
categories: [编程]
---
计算几何
4.1 二维计算几何基础
4.2 凸包
4.3 半平面交
4.4 最小圆覆盖
4.5 三维计算几何基础
4.6 三维凸包
4.7 旋转卡壳
4.8 三角剖分
4.9 扫描线
4.10 自适应辛普森积分



## 二维计算几何基础

### 基础元素的代码表示

##### 点|向量

```c++
struct Point{
	int x,y;
};
```

##### 直线|射线

```c++
斜率式：y=kx+b;
点向式：p+tv  //p为直线上一点，v为方向向量，每一个t对应一个点
```

##### 线段

记录左右端点即可。

##### 多边形

使用数组按一定顺序记录多边形的每个顶点即可。

##### 曲线图形

一些特殊曲线，如函数图像等一般记录其解析式。对于圆，直接记录其圆心和半径即可。

### 基本公式

1. 正弦定理         $ \begin{aligned} \frac{A}{sinA}=\frac{b}{sinB}+\frac{c}{sinC}\end{aligned} $
2. 余弦定理        

### 基本操作

##### 判断点与直线的位置

已知直线的方向向量$\mathbf{v}$，以及直线上一点P，判断点Q与直线的关系。

计算$\mathbf{v}×\overrightarrow {PQ}$，若向量积为（左右相对于方向向量而言）

- 负：Q在直线右侧
- 正：Q在直线左侧
- 0： Q在直线上

```c++
double cross(Point a,Point b){
	return a.x * b.y - b.x * a.y;
}
void on_line(Point p,Point a,Point b){
	Vector v = b - a,u = p - a;   //vector是向量的意思
	if(cross(v,u) == 0)  cout << "on";
	else if(cross(v,u) > 0)  cout << "left";
	else  cout << "left";
}
```

##### 判断两条线段是否相交

1. 斜率相等，两线段平行，则不可能相交；

2. 快速排斥实验：以两线段为对角线的矩形区域若不重叠则一定不相交；

3. 跨立实验：分别判断两条线段的两个端点是否位于另一条线段的两侧；

   ```c++
   bool segment_intersection(Point a1,Point a2,Point b1,Point b2)
   {
   	double c1 = cross(a2 - a1,b1 - a1), c2 = cross(a2 - a1,b2 - a1);
   	double c3 = cross(b2 - b1,a2 - b1), c4 = cross(b2 - b1,a1 - b1);
   	return (c1 * c2 <= 0 && c3 * c4 <= 0);
   }
   ```

##### 判断一点是否在多边形内部

###### 光线投射算法

以该点为端点引出一条射线，如果这条射线与多边形有奇数个交点，则该点在多边形内部，否则该点在多边形外部，我们简记为**奇内偶外**。

###### 回转数算法

把该点与多边形的所有顶点连接起来，计算相邻两边夹角的和。注意这里的夹角是**有方向的**。如果夹角和为0，则这个点在多边形外，否则在多边形内。

##### 求两条直线的交点

先确定两条直线是否平行，若相交则计算交点。

```c++
Point intersection(Point p, Vector v, Point q, Vector w){ //使用点向式表示直线
	Vector u=p-q;
	double t=cross(w,u)/cross(v,w);
	return {p.first+t*v.first, p.second+t*v.second};
}
```

##### 求任意多边形的周长和面积

1. 三角形的面积

   ```c++
   p = (a+b+c) / 2;
   s = sqrt(p * (p-a) * (p-b) * (p-c));
   ```

2. 多边形的面积

   任取平面上一点P，多边形面积为（以四边形ABCD为例）：

   $ \begin{aligned} S_{多边形面积}=\frac{\overrightarrow {PA}×\overrightarrow {AB}+\overrightarrow {PB}×\overrightarrow {BC}+\overrightarrow {PC}×\overrightarrow {CD}+\overrightarrow {PD}×\overrightarrow {DA}}{2}\end{aligned} $

   ```c++
   //方法一：枚举每个点，这里取原点o作为定点方便计算
   double polygon_area(Point p[],int n)
   {
   	double s = 0;
   	for(int i = 1;i < n;i++)
   		s += cross(p[i],p[i-1]);	//cross是计算叉积
   	s += cross(p[n-1],p[0]);
   	return s / 2;
   }
   
   //方法二：枚举多边形的每条边，如上图
   double polygon_area(Point p[],int n)
   {
   	double s = 0;
   	for(int i = 1;i < n-1;i++)
   		s += cross(p[i] - p[0],p[i+1] - p[i]);
   	return s / 2;
   }
   ```

##### 圆与直线相关

###### 求直线与圆的交点

首先判断直线与圆的位置关系。如果直线与圆相离则无交点，若相切则可以利用切线求出切点与半径所在直线，之后转化为求两直线交点。

若有两交点，则可以利用勾股定理求出两交点的中点，然后沿直线方向加上半弦长即可。

###### 求两圆交点

首先我们判断一下两个圆的位置关系，如果外离或内含则无交点，如果相切，可以算出两圆心连线的方向向量，然后利用两圆半径计算出平移距离，最后将圆心沿这个方向向量进行平移即可。

如果两圆相交，则必有两个交点，并且关于两圆心连线对称。因此下面只说明一个交点的求法，另一个交点可以用类似方法求出。

我们先将一圆圆心与交点相连，求出两圆心连线与该连线所成角。这样，将两圆心连线的方向向量旋转这个角度，就是圆心与交点相连形成的半径的方向向量了。沿方向向量方向将圆心平移半径长度即可得到一个交点。

##### 极角序



## 三维计算几何基础

##### 三正弦定理

二面角度数为$a$，平面M上有一条射线AC，它和棱AB所成角为$b$，和平面N所成角为$r$，则

$sin r=sina*sinb$

##### 三余弦定理

设O为平面上一点，过平面外一点B的直线BO 在面上的射影为AO，OC为面上的一条直线，那么 $∠COB，∠AOC，∠AOB$三角的余弦关系为$cos∠BOC=cos∠AOB*cos∠AOC$（$∠AOB$和$∠AOC$只能是锐角）

## 常用距离

#### 欧氏距离

[欧式距离 中](https://www.luogu.com.cn/problem/P3958#ide)

#### 曼哈顿距离

[曼哈顿距离 易](https://www.luogu.com.cn/problem/P5098#ide)

#### 切比雪夫距离

$d(A,B)=max(∣x_1−x_2∣,∣y_1−y_2∣)$

