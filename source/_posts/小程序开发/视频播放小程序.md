---
title: 实验报告——视频播放小程序
date: 2025-09-02 10:00:00
tags: [小程序开发, 实验]
categories: [小程序]
---

## 实验目标

1. 掌握视频列表的切换方法；
2. 掌握视频自动播放方法；
3. 掌握视频随机颜色弹幕效果。

## 实验步骤

#### 创建空项目并完成页面配置

1. 创建新项目

   <img src="/chunk.github.io/images/屏幕截图 2025-09-01 160820.png" alt="屏幕截图 2025-09-01 160820" style="zoom:50%;" />

2. 进行页面配置

   - 删除`index.wxml`、`index.wxss`和`app.wxss`中的所有代码；

       <img src="/chunk.github.io/images/屏幕截图 2025-09-01 161001.png" alt="屏幕截图 2025-09-01 161001" style="zoom:50%;" />

   - 删除`index.js`中的所有代码并输入`"page"`使其自动补全函数；删除`app.js`中的所有代码并输入`"app"`使其自动补全函数。

     <img src="/chunk.github.io/images/屏幕截图 2025-09-01 161046.png" alt="屏幕截图 2025-09-01 161046" style="zoom:50%;" />

3. 创建`images`文件存放播放图标

   <img src="/chunk.github.io/images/屏幕截图 2025-09-01 161329.png" alt="屏幕截图 2025-09-01 161329" style="zoom:50%;" />

#### 视图设计

##### 导航栏设计

改动`app.json`中代码，将导航栏背景改为金棕色

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 161710.png" alt="屏幕截图 2025-09-01 161710" style="zoom:50%;" />

##### 页面设计

###### 区域1：视频播放器

使用`<video>`组件实现一个视频播放器，在`index.wxml`中添加如图所示代码，其中controls属性用于播放/暂停、音量等控制组件。

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 162123.png" alt="屏幕截图 2025-09-01 162123" style="zoom:50%;" />

可以看到此时播放器未居中，且没有填满一行。接下来我们在`index.wxss`中添加如图所示代码，将视频组件的宽度调整为填满一行。

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 162420.png" alt="屏幕截图 2025-09-01 162420" style="zoom:50%;" />

###### 区域2：弹幕发送区域

使用`<view>`组件实现一个单行区域，包括文本输入框和发送按钮。在`index.wxml`中添加如图所示代码，输入框使用`<input>`实现，发送按钮使用`<button>`实现。

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 162828.png" alt="屏幕截图 2025-09-01 162828" style="zoom:50%;" />

可以看到此时的组件为纵向排列，且输入框和发送按钮字体大小不一样，总体外观很丑，之后更改`index.wxss`中代码。

通过`flex`将两个组件改为横向排列，用`flex-grow`让文本输入框扩展多余空间使区域2填满整行，同时调整字体及背景颜色。

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 163425.png" alt="屏幕截图 2025-09-01 163425" style="zoom:50%;" />

###### 区域3：视频列表

使用`<view>`组件实现一个可扩展的多行区域，每行包括一个播放图标和一个视频标题文本。首先设计第一行效果（后续使用for循环添加多行），在`index.wxml`中添加如图所示代码。

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 163957.png" alt="屏幕截图 2025-09-01 163957" style="zoom:50%;" />

之后我们在`index.wxss`中更新各组件样式，使图标与文字样式更协调。

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 165340.png" alt="屏幕截图 2025-09-01 165340" style="zoom:50%;" />

#### 逻辑实现

##### 更新播放列表

在区域3添加`wx:for`属性，实现循环展示列表。

<img src="/chunk.github.io/images/屏幕截图 2025-09-01 170716.png" alt="屏幕截图 2025-09-01 170716" style="zoom:50%;" />

然后在JS文件的data属性中追加list数组，用于存放视频信息。

<img src="/chunk.github.io/images/屏幕截图 2025-09-02 091506.png" alt="屏幕截图 2025-09-02 091506" style="zoom:50%;" />

##### 点击播放视频

在区域3的`videoBar`部分添加`data-url`属性和`bindtap`属性，其中前者用于记录每行视频对应的播放地址，后者用于触发点击事件。

<img src="/chunk.github.io/images/屏幕截图 2025-09-02 083139.png" alt="屏幕截图 2025-09-02 083139" style="zoom:50%;" />

发现运行时控制台报错，更改play函数为图中所示代码。

<img src="/chunk.github.io/images/屏幕截图 2025-09-02 093337.png" alt="屏幕截图 2025-09-02 093337" style="zoom:50%;" />

##### 发送弹幕

在区域1对`<video>`组件添加`enable-danmu`和`danmu-btn`属性，用于允许发送弹幕和显示“发送弹幕”。

然后在区域2为文本输入框追加`bindinput`属性，用于获取弹幕文本内容；为按钮追加`bindtap`属性，用于触发点击事件。

并在JS文件中添加相应的`getDanmu`和`sendDanmu`函数。

此时可以成功发送红色弹幕，效果如图所示。

<img src="/chunk.github.io/images/屏幕截图 2025-09-02 085559.png" alt="屏幕截图 2025-09-02 085559" style="zoom:50%;" />

为了可以发送随机颜色的弹幕内容，在JS文件中追加自定义函数`getRandomColor`函数，通过随机数来随机生成rgb颜色并同步更新`sendDanmu`函数中关于color的部分:`color:getRandomColor()`

<img src="/chunk.github.io/images/屏幕截图 2025-09-02 090433.png" alt="屏幕截图 2025-09-02 090433" style="zoom:50%;" />

## 程序运行结果

小程序可以成功切换视频或停止播放，弹幕功能良好：

<img src="/chunk.github.io/images/屏幕截图 2025-09-02 090543.png" alt="屏幕截图 2025-09-02 090543" style="zoom:50%;" />

## 问题总结与体会

### 遇到的主要问题

1. 打字错误频繁：在编写代码过程中经常打错字母，特别是在写函数名和属性名的时候，导致程序运行出错。需要更加仔细地检查代码拼写。

2. play()函数报错问题：在运行`play()`函数时遇到了报错，虽然能看懂报错信息，但一开始不明白具体是什么意思。后来询问AI才发现是因为`play`函数会被`pause`中断，解决方法是在`playVideo`函数里加了一个延迟播放的处理。

### 学习收获

1. 组件设置的深入理解：通过这次实验，对小程序中各种组件的设置有了更深入的理解，特别是`<video>`组件的各种属性配置。

2. `wx:for`循环的掌握：学会了使用`wx:for`循环来设置循环输出，这让我能够动态地展示视频列表，而不用手动写很多重复的代码。

3. 随机颜色功能实现：学会了如何通过`JavaScript`生成随机RGB颜色，并应用到弹幕功能中，让弹幕显示更加丰富多彩。

4. 事件绑定和数据传递：掌握了如何使用`bindtap`绑定点击事件，以及通过`data-`属性传递数据，这些都是小程序开发中的基础但重要的技能。

总的来说，这次实验让我对小程序的开发流程有了更全面的认识，虽然过程中遇到了一些问题，但通过解决这些问题也学到了很多实用的技巧。

