---
title: 公钥密码学
date: 2025-04-10 10:47:00
tags: [密码学，笔记]
categories: [密码学]
---
#### 概述
> 由于对称加密体制存在的许多问题，公钥密码学被提出
##### 提出
- 1976年，Diffie与Hellman提出公钥密码体制的设想
- Diffie-Hellman 密钥交换协议
- 公钥技术是二十世纪最伟大的思想之一，密码学的一次伟大革命
##### 解决问题
- 从未见过面的两个人如何实现秘密通信
- Diffie-Hellman 密钥交换协议 只设想了该种可能，并未提出解决方案
##### RSA的发明
> 1978年，MIT的三位密码学家 Rivest，Shamir，Adleman联合发明RSA加密体制
#### Diffie-Hellman密钥交换协议
##### 概述
   <img src="/chunk.github.io/images/830dc41f80d9cf9a0c0ab752ab94cc22.jpg" alt="830dc41f80d9cf9a0c0ab752ab94cc22" style="zoom:50%;" />
##### 安全性
   <img src="/chunk.github.io/images/229d83b58fa7e05091991bc63a5ad5c6.jpg" alt="229d83b58fa7e05091991bc63a5ad5c6" style="zoom:50%;" />
   - Diffie-Hellman问题
     <img src="/chunk.github.io/images/c298dc7d3dd61bcced0b2fb98e13ca5e.jpg" alt="c298dc7d3dd61bcced0b2fb98e13ca5e" style="zoom:50%;" />
     安全性基于在有限域上的离散对数问题！
   - 攻击手段
     > 中间人攻击（Man-in-the-Middle Attack）：主动攻击下不安全
     
     <img src="/chunk.github.io/images/03574744b6adf0783c0ac388dc0f889a.jpg" alt="03574744b6adf0783c0ac388dc0f889a" style="zoom:50%;" />
   > 如何抵抗中间人攻击——需要对交换的数据进行==认证==，以使通信双方知道到底在与谁进行密钥交换
#### 公钥加密体制
* ##### 定义
  > 一个公钥加密体制包含以下算法:
  <img src="/chunk.github.io/images/c65b1970dced63ac545eb9879e800a84.jpg" alt="c65b1970dced63ac545eb9879e800a84" style="zoom:50%;" />
  > 一致性要求: 
  Setup输出的 ∀(pk,  sk) : 对于∀m∈M，有 Dec(sk, Enc(pk, m)) = m
  
* #####  密码通信模型
  <img src="/chunk.github.io/images/6dae3a9ffbc4010c5061efec10fa15f1.jpg" alt="6dae3a9ffbc4010c5061efec10fa15f1" style="zoom:50%;" />
  
* ##### 陷门函数（trapdoor function, TDF ）
  
  ##### <img src="/chunk.github.io/images/e19a3ae45c199b8c193fc9fb9b177b54.jpg" alt="e19a3ae45c199b8c193fc9fb9b177b54" style="zoom:50%;" />
  
  * ##### 单向陷门函数
    <img src="/chunk.github.io/images/be61d5eb4a502f27aefd4470b12d195a.jpg" alt="be61d5eb4a502f27aefd4470b12d195a" style="zoom:50%;" />
    
    - 安全性
    > 如果所有高效的攻击者 A，在上述安全模型中
    >                               Adv :=  Pr[ x = x’ ]  
    > 是可忽略的，则 (G, F, F^-1)  是安全的陷门函数 (此时称之为单向陷门函数，one-way trapdoor function, one-way TDF) 
    
  * ##### 基于one-way TDF构造公钥加密体制
    <img src="/chunk.github.io/images/df775d8de55375e0745afe59ea2eda67.jpg" alt="df775d8de55375e0745afe59ea2eda67" style="zoom:50%;" />
    
    <img src="/chunk.github.io/images/f092b37256061a59396b91be163cef50.jpg" alt="f092b37256061a59396b91be163cef50" style="zoom:50%;" />
    
    - 应用避坑指南
      <img src="/chunk.github.io/images/6423ee38c905ff34526d175912aa4225.jpg" alt="6423ee38c905ff34526d175912aa4225" style="zoom:50%;" />
  
* ##### 陷门置换
  * ###### 定义
    <img src="/chunk.github.io/images/ed3ff269cd4aa4bd0da866fbeb36bd08.jpg" alt="ed3ff269cd4aa4bd0da866fbeb36bd08" style="zoom:50%;" />
  * ###### 单向陷门置换（one-way trapdoor permutation, one-way TDP）
    <img src="/chunk.github.io/images/da093d60f74d75bb951275c6fdf8c32d.jpg" alt="da093d60f74d75bb951275c6fdf8c32d" style="zoom:50%;" />
#### RSA
##### RSA
   * ###### RSA陷门置换
     <img src="/chunk.github.io/images/98832b14f770ad4a460cb1e3ba326c20.jpg" alt="98832b14f770ad4a460cb1e3ba326c20" style="zoom:50%;" />
     
     <img src="/chunk.github.io/images/eb9b5771c556f2b2d4bfb82e98536171.jpg" alt="eb9b5771c556f2b2d4bfb82e98536171" style="zoom:50%;" />
     
   * RSA陷门置换的计算问题
     - 如何产生两个大素数？
       素数检测
     - 如何计算d？
       ed ≡ 1(mod ø(n))，事实上==d和e在模ø(n)下互为逆元==
     - 接着计算模运算下的整数求模
     
* ###### RSA假设
  <img src="/chunk.github.io/images/4e35cb1e0c8564250fc74a89a7af3ac7.jpg" alt="4e35cb1e0c8564250fc74a89a7af3ac7" style="zoom:50%;" />
```
RSA 是否是one-way TDP (安全的陷门置换)？           未知
```
* ###### 教科书式RSA
  <img src="/chunk.github.io/images/f931f16485675a8c5bf7628964e7eb56.jpg" alt="f931f16485675a8c5bf7628964e7eb56" style="zoom:50%;" />
* 不安全的加密方法 ！！！
  不是语义安全的，存在很多攻击方法
  ⇒ **==RSA 陷门置换只是个函数，不是加密体制==，不能直接拿来用!**
* 安全性
  * ？可看作大整数分解问题—未定
    已知 n 是两个大素数 p 和 q 的乘积，对 n 进行分解，求出 p 和 q
  * ###### 安全隐患   实际应用RSA时要注意很多问题，否则攻击者即使不知道陷门信息，仍可以发动各种形式的攻击
    - 共模攻击
    - 低加密指数攻击
    - 低解密指数攻击
    - 选择密文攻击
      ……
  - 共模攻击
  <img src="/chunk.github.io/images/334abbb5681acf21f5bbf7734a23c658.jpg" alt="334abbb5681acf21f5bbf7734a23c658" style="zoom:50%;" />
* ###### 参数和性能
  - 一般选择p、q为安全素数
    - 安全素数：形如p=2m+1的素数，m也是素数
    - 目的：确保p-1、q-1都有大的素因子，增加猜测φ(n)的难度
  - e的选择
    - 一般选 ==**e=3、17、65537(2^16+1）**==
  - d要大于某个值，否则易遭攻击（Wiener’s attack）
  - 执行的非对称性:  加密快 / 解密慢
* ###### 主要缺点
  - 安全性问题
    - 还无法证明对RSA的破译是否等同于大整数分解问题
    - 只是到目前为止，RSA似乎是安全的
  - 速度问题
    - 增大p和q将使计算开销指数级增长
  - 选择合适的p和q对普通用户很困难
##### PKCS
```
永远不要使用“教科书式RSA”，实际应用中如何使用？
```
<img src="/chunk.github.io/images/4a73de3696ff8525e011539ef10f48e4.jpg" alt="4a73de3696ff8525e011539ef10f48e4" style="zoom:50%;" />

- 优化的非对称加密填充:  OAEP ——是CCA安全的
  <img src="/chunk.github.io/images/defb5709c4fcd876cdcef4ea185be854.jpg" alt="defb5709c4fcd876cdcef4ea185be854" style="zoom:50%;" />
  
- OAEP的变种
  <img src="/chunk.github.io/images/b3a70b592a0ad5d3a4512f4e5a71fe5b.jpg" alt="b3a70b592a0ad5d3a4512f4e5a71fe5b" style="zoom:50%;" />

  <img src="/chunk.github.io/images/1360d8c44ca1be1f146017219815d44a.jpg" alt="1360d8c44ca1be1f146017219815d44a" style="zoom:50%;" />
#### 小结
##### 公钥密码的缺点
   - 计算速度慢
   - 密钥长（公钥密码的密钥分发并不简单）
   - 应用历史短
##### 关于公钥密码的错误认识
   - 公钥密码更安全
   - 对称密码体制已经过时
     - RSA最快的情况也比DES慢上100倍，速度一直是公钥密码体制的缺陷。
   - 公钥分发十分简单
