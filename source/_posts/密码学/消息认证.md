---
title: 消息认证
date: 2025-04-21 16:34:00
tags: [密码学，笔记]
categories: [密码学]
---


### 概述
###### 主要目标
- 完整性：消息是否被改动过
- 真实性：消息是否是指定发送者发来的
###### 认证加密——同时保证机密性和完整性
### 认证加密（AE,authenticated encryption）
> 确认消息的来源
##### 定义
一个AE系统 (E,D) 是一个对称加密体制
- 加密算法:  E:  K × M × N ⟶ C
- 解密算法:  D:  K × C × N ⟶  M ∪ {⊥} //密文不合法时，拒绝接收
- N是nonce空间（可选）

##### 安全性
对(E,D)的要求:
- CPA安全性
- 密文完整性 (攻击者不能伪造出可以正确解密的新密文)

##### 密文完整性（安全模型）
<img src="/chunk.github.io/images/5275fd290f8768982566aac5981b4af7.jpg" alt="5275fd290f8768982566aac5981b4af7" style="zoom:50%;" />

<img src="/chunk.github.io/images/64c1141717bc0c8945824c6d10509467.jpg" alt="64c1141717bc0c8945824c6d10509467" style="zoom:50%;" />

(E,D) 具有密文完整性，则对于任意高效攻击者A，在上述安全模型中伪造成功的概率
Adv = Pr[ A伪造成功 ]  是可忽略的

####  AE的性质
* ##### 保证真实性
  - 攻击者不能欺骗 Bob，使他认为消息来自于Alice
  - 如果  Dₖ(c) ≠ ⊥, Bob 知道消息来自 Alice (因为她知道密钥 k)
    (但不能抵抗旧消息重放) 
* ##### AE  ⇒ CCA安全性 

### CCA安全性
#### 攻击者攻击能力
* ##### CPA（选择明文攻击）
  选择任意明文，并获得相应的密文
* ##### CCA（选择密文攻击）
  选择任意密文 (除了挑战密文)，并获得相应的明文

#### 攻击者攻击目的
- 破坏语义安全性

#### 安全模型
<img src="/chunk.github.io/images/832fd60e6fa5e7e0752a1604f69bd322.jpg" alt="832fd60e6fa5e7e0752a1604f69bd322" style="zoom:50%;" />

<img src="/chunk.github.io/images/8e51c8d99d9830ae7f986fa105ab0fd6.jpg" alt="8e51c8d99d9830ae7f986fa105ab0fd6" style="zoom:50%;" />

<img src="/chunk.github.io/images/2ca6355f3329935dceb7c612f115e265.jpg" alt="2ca6355f3329935dceb7c612f115e265" style="zoom:50%;" />

如果一个对称加密体制是CCA安全的，则对于任意高效的攻击者A, 在上述安全模型中
Adv = | Pr[EXP(0)=1] – Pr[EXP(1)=1] |         是可忽略的。

### AE的构造
#### ENC+MAC
* ##### MAC-then-Enc
  - CCA攻击下可能不安全
  - 当IV是随机数时，采用CBC和CTR模式是CCA安全的
  - 标准：CCM
* ##### ==Enc-then-MAC (MAC密文)==
  - 标准：GCM
* #####  Enc-and-MAC (MAC明文)
  - 不推荐使用
  - 标准：EAX

#### MAC安全性暗示
(m , t) ⇏ (m , t’)
假设攻击者可以做到:  (m , t)   ⟶  (m , t’)
那么 Enc-then-MAC 就不是CCA安全的 (将无法保证密文完整性) !!
<img src="/chunk.github.io/images/de10e43e7b18d191f57c7effb8c8105a.jpg" alt="de10e43e7b18d191f57c7effb8c8105a" style="zoom:50%;" />

<img src="/chunk.github.io/images/3fe00474631f3f8c5ac7a755a69c04a3.jpg" alt="3fe00474631f3f8c5ac7a755a69c04a3" style="zoom:50%;" />

#### OCB模式
```
基于PRP直接构造认证加密
```
简述：比 ENC+MAC 方式更快，完全可并行
<img src="/chunk.github.io/images/ac0db0f35eeb2c79395b6683aae32ae4.jpg" alt="ac0db0f35eeb2c79395b6683aae32ae4" style="zoom:50%;" />
