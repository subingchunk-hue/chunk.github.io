---
title: 对称密码
date: 2025-03-24 12:07:00
tags: [密码学，笔记]
categories: [密码学]
excerpt: 对称密码体制基础知识，包括流密码、分组密码的原理和安全性分析。
---

##### 对称加密体制
定义：对称加密体制是一对高效的算法 E 和 D，
              E:  K × M  ->  C
              D:  K × C  ->  M，
      满足 D(k, E(k, m)) = m, ∀ m ∈ M，k ∈ K，
      M、C、K分别为明文空间、密文空间、密钥空间
##### 流密码
###### 随机性
   * 作用
     - 随机数可以作为密钥使用
     - 在密码体制和安全协议的构造中得到广泛应用
   * 是否存在真正的随机性是一个**哲学问题**
     - **量子力学告诉我们：现实世界中存在随机性**
     - 随机序列
       *  性质：不能靠重复产生（完全相同的两个输入得到的是不相关的序列）
       * 数学解释：概率服从均匀分布（产生每个比特的概率为1/2）
       * 产生方法：使用专门的设备，输入各种无法预测的信号，则输出也就不可重复
   * **电子计算机不能产生真正的随机序列**（伪随机序列，产生的随机数是大周期的）
     冯诺依曼（John von Neumann） 
     *任何人考虑用数学的方法产生随机数，肯定是不合理的！*
###### 一次一密（OTP,one-time pad）
   * 原理
     - 加密：明文流与密钥流相异或
     - 解密：密文流与密钥流相异或
   * 密钥流是随机序列，且不重复使用
###### 完善保密性
   `一次一密是否安全？如何界定“安全”？`
   香农 *唯密文攻击下，密文不能泄露明文的任何信息！*
   * 提出完善保密性（考虑**唯密文攻击**）

   * 定义
     <img src="/chunk.github.io/images/d45d6e789a8eb6410a2fc6bd0c248e0b.jpg" alt="d45d6e789a8eb6410a2fc6bd0c248e0b" style="zoom:50%;" />
     
   * 例题
      `一次一密中，给定明文m和其密文c，对应的密钥k有多少个？`
      $k=m$^$c$ 

   唯一一个密钥

   * 一次一密具有完善保密性(自行证明)
     
   * 对称加密体制具有完善保密性

   * 香农定理:完善保密性  ⇒  |K| ≥ |M|
     即要满足完善保密性，所需**密钥至少和明文一样长**
     
   * 小结
     <img src="/chunk.github.io/images/749e6b676c6b262753f81b04ac5e2d04.jpg" alt="749e6b676c6b262753f81b04ac5e2d04" style="zoom:50%;" />
###### 流密码
   `如何改造一次一密使它更实用   ⇒   缩短密钥长度`
   * 基本思想
     使用“**伪随机”密钥流** 代替 “随机”密钥流
   * 使用工具
     “**伪随机生成器”（PRG）**
   * 实现方法
     利用一个**短的随机密钥**(称作“种子”) 作为PRG的输入，由PRG产生          **伪随机密钥流**，再与明文流/密文流异或。
     <img src="/chunk.github.io/images/f7abf266e04636561d306c145a37d2ad.jpg" alt="f7abf266e04636561d306c145a37d2ad" style="zoom:50%;" />
   * PRG
     - 定义：G是一个高效的确定性函数，如果G是一个PRG，则它可以由一个长度很短的种子空间产生一个很长的输出。
     - 安全性
       设G是一个PRG，如果对于任何高效的算法，成功区分G的输出和等长的随机序列的概率都是可忽略的 (计算上不可区分)，则 G是一个安全的PRG
     - 用途
       * 流密码（用于加密）
       * 生成随机序列、随机数
       * 生成密钥
     - G是不可预测的 ⇒ G是安全的
       不可预测性：给定输出的某些比特，高效预测其他任一比特的成功概率可忽略
   - 种子的收集
     * 攻击者可能尝试重构生成密钥流的种子
       * 攻击原理：由柯克霍夫斯原则可知攻击者知道你收集种子的方法，如果种子不够好可以被重构
     * 收集方法：
       * 毫秒计的时间
       * 用户的输入
       * 鼠标点击的位置
       * ……
   * 例题
     流密码是否能达到完善保密性？
     不能，因为密钥比明文短
   * 小结
     <img src="/chunk.github.io/images/407335bb193bc82af970e7b8f53d094b.jpg" alt="407335bb193bc82af970e7b8f53d094b" style="zoom:50%;" />
###### 语义安全性
   `流密码不具有完善保密性，那怎么衡量他的安全性   ⇒  语义安全性`
   * 安全模型
     <img src="/chunk.github.io/images/a085db62826d3db33d4af98a21e1daf2.jpg" alt="a085db62826d3db33d4af98a21e1daf2" style="zoom:50%;" />
   * 定义
     `如果一个对称加密体制是语义安全的，它应满足以下条件：
     在上述安全模型中，对于所有高效的攻击者A,
           Adv :=| Pr[ EXP(0)=1] −  Pr[ EXP(1)=1 ] |
     是可忽略的，Pr[ EXP(b)=1] 表示 A 在 EXP(b) 中返回 1的概率   (b=0,1)`
   * 一次一密是语义安全的<img src="/chunk.github.io/images/08903dff11789c2d10c23e01e2f9f91a.jpg" alt="08903dff11789c2d10c23e01e2f9f91a" style="zoom:50%;" />

   * PRG是安全的 ⇒ 相应的流密码是语义安全的
     <img src="/chunk.github.io/images/a94c296e77fb52d3185bcd2f1e25f7f0.jpg" alt="a94c296e77fb52d3185bcd2f1e25f7f0" style="zoom:50%;" />
     经典算法

   - RC4

   - eStream 计划

   - LFSR-based stream ciphers
      流密码的密钥不能重复使用！
      <img src="/chunk.github.io/images/81bc4c22415f6c4751f748d29c738d9d.jpg" alt="81bc4c22415f6c4751f748d29c738d9d" style="zoom:50%;" />
      **想重复使用密钥时，不要“直接”使用流密码**
      教训（two-time pad) ⇒    每帧使用一个伪随机密钥   
      小结
   
   <img src="/chunk.github.io/images/72e842694e56ca35bb1832250c7ba746.jpg" alt="72e842694e56ca35bb1832250c7ba746" style="zoom:50%;" />

### [分组密码](./分组密码/)
### 对称密码的缺陷
- 密钥管理困难
        多人相互通信时密钥爆炸
- 无法实现“非否认”
        通信双方有相同的密钥，无法区别该计算由谁做
- 共享密钥困难（密钥分发困难）
        密钥难以分发给对方
